function runLater(e){"requestIdleCallback"in window?requestIdleCallback(e):setTimeout(e,300)}function initSite(){initTheme(),initNav(),runLater(initReveal),runLater(initTypewriter),runLater(initScrollbar),runLater(initVideo),initLoader()}function initTheme(){const e=document.documentElement;requestAnimationFrame((()=>{const t=localStorage.getItem("theme")||"light";e.setAttribute("data-theme",t)}));const t=document.getElementById("darkModeToggle");t&&t.addEventListener("click",(()=>{const t="dark"===e.getAttribute("data-theme")?"light":"dark";e.setAttribute("data-theme",t),localStorage.setItem("theme",t)}))}function initNav(){const e=document.getElementById("navToggle"),t=document.querySelector("header nav");if(!e||!t)return;const n=document.body,i=document.createElement("div");function o(){e.classList.remove("active"),t.classList.remove("active"),i.classList.remove("active"),n.classList.remove("nav-open")}let r;i.className="nav-overlay",document.body.appendChild(i),e.addEventListener("click",(function(){e.classList.toggle("active"),t.classList.toggle("active"),i.classList.toggle("active"),n.classList.toggle("nav-open")})),i.addEventListener("click",o),document.querySelectorAll(".nav-link a").forEach((e=>{e.addEventListener("click",o)})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&t.classList.contains("active")&&o()})),window.addEventListener("resize",(()=>{clearTimeout(r),r=setTimeout((()=>{window.innerWidth>=768&&o()}),250)}))}function initLoader(){const e=document.querySelector("#loader");e&&(e.classList.add("loader-hidden"),document.body.classList.add("loaded"),e.addEventListener("transitionend",(()=>e.remove())))}function initReveal(){const e=document.querySelectorAll(".reveal");if(!e.length)return;const t=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.classList.add("active"),t.unobserve(e.target))}))}),{threshold:.15});e.forEach((e=>t.observe(e)))}function initTypewriter(){const e=document.getElementById("typewriter");if(!e)return;const t=JSON.parse(e.getAttribute("data-words"));let n=0,i=0,o=!1,r=!0;function s(){if(r)return;const a=t[n];o?(e.textContent=a.substring(0,i-1),i--):(e.textContent=a.substring(0,i+1),i++);let c=o?50:150;o||i!==a.length?o&&0===i&&(o=!1,n=(n+1)%t.length,c=250):(o=!0,c=2e3),setTimeout(s,c)}document.addEventListener("visibilitychange",(()=>{document.hidden?r=!0:(r=!1,s())}));new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?(r=!1,s()):r=!0}))}),{threshold:.1}).observe(e)}function initScrollbar(){const e=document.getElementById("custom-scrollbar");if(!e)return;const t=document.querySelector("header"),n=document.querySelector("footer");let i,o=!1;const r=()=>{const r=window.innerHeight,s=document.documentElement.scrollHeight,a=window.scrollY,c=t?t.offsetHeight:0,d=n?n.getBoundingClientRect():null,l=r-c-(d&&d.top<r?r-d.top:0),u=r/s,m=Math.max(l*u,40),v=s-r,g=(v>0?Math.min(a/v,1):0)*(l-m);e.style.top=`${c}px`,e.style.height=`${m}px`,e.style.transform=`translate3d(0,${g}px,0)`,e.classList.add("visible"),clearTimeout(i),i=setTimeout((()=>{e.classList.remove("visible")}),1200),o=!1},s=()=>{o||(requestAnimationFrame(r),o=!0)};window.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s),s()}function initVideo(){const e=document.getElementById("bg-video");if(!e)return;const t=navigator.connection&&navigator.connection.saveData;window.innerWidth<768||t||(e.innerHTML='<source src="./video/web-bg-video.mp4" type="video/mp4">',e.load())}window.addEventListener("load",(()=>{initSite()}));
